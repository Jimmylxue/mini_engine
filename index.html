<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>mini_engine</title>
		<style>
			#myCanvas {
				background-color: #95a5a6;
				/* width: 500px;
				height: 500px; */
			}
		</style>
	</head>
	<body>
		<script src="mini_engine.js"></script>
		<script src="mini_engine.min.js"></script>
		<canvas id="myCanvas" width="500" height="500"></canvas>

		<script>
			const { Display, Rect, Circle, Image: CImage, Text } = mini_engine
			const canvas = document.getElementById('myCanvas')
			const ctx = canvas.getContext('2d')

			const display = new Display(canvas, ctx)
			const rect = new Rect({
				leftTop: { x: 0, y: 0 },
				width: 100,
				height: 100,
			})
			display.add(rect)
			const rect1 = new Rect({
				leftTop: { x: 10, y: 10 },
				width: 100,
				height: 100,
				fillColor: 'red',
			})
			display.add(rect1)

			const cImg = new CImage({
				leftTop: {
					x: 200,
					y: 200,
				},
				width: 50,
				height: 50,
				source:
					'https://camo.githubusercontent.com/a1b76a151151e76cb92576d88cec16d910faa7e9e37dee007732567143642335/68747470733a2f2f7669746570726573732d736f757263652e6f73732d636e2d6265696a696e672e616c6979756e63732e636f6d2f7479706f726162672e6a7067',
				// 'a.png',
			})

			display.add(cImg)

			rect.on('mousedown', event => {
				event.isStopBubble = true
				console.log('rect点击了~~~~~~~~~', event)
			})

			rect.on('mouseup', event => {
				event.isStopBubble = true
				console.log('rect结束~~~~~~~~~', event, this)
				rect.change(
					{
						leftTop: {
							x: 100,
							y: 100,
						},
						width: 200,
						height: 200,
						fillColor: '#e67e22',
					},
					display
				)
			})

			rect.on('touchmove', event => {
				event.isStopBubble = true
				console.log('rectmove~~~~~~~~~', event)
			})

			// rect1.on('mousedown', event => {
			// 	// event.isStopBubble = true
			// 	console.log('rect1点击了', event)
			// })
			let isDown = false
			cImg.on('mousedown', () => {
				isDown = true
			})

			cImg.on('mouseup', () => {
				isDown = false
			})

			cImg.on('mousemove', event => {
				if (!isDown) {
					return
				}
				let startPoint = {
					x: event.point.x - 100,
					y: event.point.y - 100,
				}
				cImg.change(
					{
						// leftTop: event.point,
						leftTop: startPoint,
						width: 200,
						height: 200,
						fillColor: '#e67e22',
					},
					display
				)
			})

			const text = new Text({
				x: 250,
				y: 450,
				text: '1',
				type: 'fill',
				size: 40,
			})
			display.add(text)

			let count = 0
			// let timer = setInterval(() => {
			// 	text.change(
			// 		{
			// 			text: Number(text.props.text) + Number(count),
			// 		},
			// 		display
			// 	)
			// 	count++
			// }, 3000)
			setTimeout(() => {
				console.log('变化')
				rect1.change(
					{
						leftTop: {
							x: 300,
							y: 300,
						},
					},
					100,
					0,
					() => {
						console.log('动画完成了')
					}
				)
			}, 1000)

			rect1.on('mousedown', () => {
				console.log('红色块块点击了')
			})

			// rect1.track(() => {
			// 	console.log('timer 心跳事件')
			// })

			console.log(rect1, 'sss')

			setTimeout(() => {
				display.remove(rect)
			}, 2000)
		</script>
	</body>
</html>
